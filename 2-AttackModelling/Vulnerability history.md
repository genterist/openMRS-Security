# ATTACK TREE ANALYSIS OF REGISTRATION MODULE

`AUTHOR : Zhuo Li` <br/>
`UPDATED ON : 04OCT2017` <br/>


## Description
OpenMrs used to have XSS,CSRF and XXE Injection.

1.(XSS and CSRF)Parameters that are displayed back to the user are mostly vulnerable to cross-site scripting as user input was not validate properly and as a result, the malicious script was stored by the application and executed when it was displayed back to the user.
2.(XEE Injection)The vulnerability is caused due to an error when parsing XML entities within ZIP archives and can be exploited to e.g. disclose data from local resources or cause a DoS condition (billion laughs) via a specially crafted XML file including external entity references.
3.(XSS)OpenMRS suffers from multiple stored and reflected cross-site scripting vulnerabilities when input passed via several parameters to several scripts is not properly sanitized before being returned to the user. This can be exploited to execute arbitrary HTML and script code in a user's browser session in context of an affected site.

## URL and evidence  
URL:
https://www.cvedetails.com/vulnerability-list/vendor_id-14221/product_id-29315/Openmrs-Openmrs.html
![alt text](https://github.com/genterist/openMRS-Security/blob/master/2-AttackModelling/picture/7.PNG)
https://packetstormsecurity.com/files/128748/OpenMRS-2.1-Access-Bypass-XSS-CSRF.html
![alt text](https://github.com/genterist/openMRS-Security/blob/master/2-AttackModelling/picture/8.PNG)
https://packetstormsecurity.com/files/134700/OpenMRS-2.3-1.11.4-XXE-Injection.html
![alt text](https://github.com/genterist/openMRS-Security/blob/master/2-AttackModelling/picture/9.PNG)
https://packetstormsecurity.com/files/134698/OpenMRS-2.3-1.11.4-Cross-Site-Scripting.html
![alt text](https://github.com/genterist/openMRS-Security/blob/master/2-AttackModelling/picture/10.PNG)

Itâ€™s found by the provided url. We first search by google if there is any vulnerability history with openmrs vulnerablity and found there are some( the first url). Then we use packet storm to find the details.

## Are these commonly-occurring vulnerabilities?
Yes, these are commonly-occurring vulnerabilities. Because most of the application should have a log in and registration process. Mostly, the application focused on the log in part and ignore other important part such as registration.
Also, most application contain XML entities, most of them only check the grammer or syntax of the XML, they failed to check if this is a crafted XML including external entity references which can be used by hacker.

## How do you think OpenMRS had to fix the vulnerability?
The application should not only focus on the log in part but also everywhere of the system. There should be filter and checking part before and after every options to hide useless data and protect changed data. Moreover, before starting the whole system, there also should be some checking part to see if every file is safe and authenticated.


